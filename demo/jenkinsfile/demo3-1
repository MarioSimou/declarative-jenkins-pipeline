pipeline {
    agent any
    environment {
        RELEASE="20.04"
    }
    parameters {
        string(name: "ENVIRONMENT", defaultValue: "PRODUCTION", description: "Environment to deploy")
    }

    stages {
        stage("Build"){
            parallel {
                stage("linux"){
                    steps {
                        echo "Building for $STAGE_NAME"
                    }
                }
                stage("macos"){
                    steps {
                        echo "Building for $STAGE_NAME"
                    }
                }
            }
        }
        stage("Testing"){
            steps {
                sh '''
                    echo "Runnint unit tests"
                '''
            }
        }
        stage("Deploying"){
            steps{
                echo "Deploying to ${params.ENVIRONMENT}"
                writeFile file: "test.txt", text: "hello world"
            }
        }
    }
    post {
        success {
            archiveArtifacts "test.txt"
        }
    }
}